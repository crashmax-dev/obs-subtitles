(e=>{"use strict";const t=window.portal=()=>{};function n(e="/api/me",t={},n="GET",a=null){const i=function(e){const t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));if(t)return t[2]}("PN-1-pnAdminToken"),s={};return"POST"==n?(s["content-type"]="application/json;charset=UTF-8",s["x-session-token"]=i):t.token=i,new Promise((r=>{if(!i)return r(null);requester({success:e=>r(e&&e.result||null),fail:e=>r(null)})({url:`https://admin.pubnub.com${e}`,headers:s,params:t,method:n,payload:a})}))}function a(e){return new Promise((t=>setTimeout(t,e)))}t.getUser=e=>n("/api/me"),t.getAccount=e=>new Promise((async t=>{const a=await n("/api/accounts",{user_id:e.user_id});return a.accounts.length?t(a.accounts[0]):t(null)})),t.getApps=e=>n("/api/apps",{owner_id:e.id}),t.findApp=(e,n="Twitch TV Subtitles")=>new Promise((async a=>{const i=(await t.getApps(e)).filter((e=>e.name==n));return i.length?a(i[0]):a(null)})),t.createApp=(e,t="MyApp")=>n("/api/apps",{},"POST",{name:t,owner_id:e.id,properties:{}}),t.autoApp=(e="Twitch TV Subtitles")=>{let n=null,i=null,s=null,r=null;return new Promise((async u=>{for(;!n;)n=await t.getUser(),n||await a(3e3);return i=await t.getAccount(n),s=await t.findApp(i,e),s||(await t.createApp(i,e),s=await t.findApp(i,e)),r=s.keys[0],u({keys:r,user:n,account:i,app:s})}))}})();